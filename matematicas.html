<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>biblioteca CETIS 111</title>
</head>
<body>
    <header>
        <div class="audio">
            <audio id="audio" source src="perfect-beauty-191271.mp3"></audio>
            <button class="play" onclick="togglePlayPause()"><img class="on" id="play" src="img/apagado.png" onclick="cambiarImagen()"></button>
        </div>
        <div class="contenedorTitulop"> <h1 class="tituloPrincipal">MATEMÁTICAS</h1> </div>
        <img class="logo-imagen" src="logo.png" alt="logo-imagen">
    </header>
    <h1 class="relleno">MECATRONICA</h1>
    
    <div class="contenedorBuscador1">
        <input type="text" id="searchInput" placeholder="Buscar libros..." onkeyup="searchBooks()">
        <button class="limpiarBuscador" onclick="clearSearchInput()">Limpiar</button>
    </div>
    
        <div class="contenedorBuscaLetras">
            <label class="buscador_primera_letra">Buscar por primera letra del título:</label>
            <input type="text" id="searchInput2" maxlength="1">
        </div>
    
        <!-- Botón para abrir el formulario modal -->
    <button id="openFormButton">Nuevo Libro</button>
    <button id="removeLastBookButton">Eliminar último libro</button>

    <!-- Modal para agregar libros -->
    <div id="addBookModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <form id="addBookForm">
                <h1>Formulario para agregar libros:</h1>
                <label>Agrega la portada del libro:</label>
                <input type="text" id="bookImage" placeholder="URL de la imagen de portada del libro (debe terminar en el tipo de imagen que es)" required>
                <input type="text" id="bookAuthor" placeholder="Autor del libro" required>
                <input type="text" id="bookTitle" placeholder="Título del libro" required>
                <input type="number" id="year" placeholder="Año (opcional)" min="0">
                <input type="text" id="bookCity" placeholder="Ciudad" required>
                <input type="text" id="bookEditorial" placeholder="Editorial" required>
                <input type="text" id="bookLink" placeholder="URL del PDF del libro" required>
                <button type="submit">Agregar Libro</button>
            </form>
        </div>
    </div>

    <!-- Sección de libros -->
    <div id="SectionNewBooks">

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="aritmetica teorica practica.png"></center>
            <h2 class="titulos">Aritmética</h2>
            <center><p class="autor">Autor: Baldor, Aurelio, Monroy M., José Luis</p></center>
            <center><a href="https://carc1975.wordpress.com/wp-content/uploads/2018/07/aritmetica-de-baldor.pdf"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="./img/una breve historia.png"></center>
            <h2 class="titulos">Breve historia de las matemáticas</h2>
            <center><p class="autor">Autor: Stedall.J.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://www.researchgate.net/publication/361477215_Breve_historia_de_la_matematica_Una_mirada_didactica&ved=2ahUKEwjVuP2LqomGAxXGH0QIHWbHB7gQFnoECDAQAQ&usg=AOvVaw0gfjWNZf9zkdjM7JHhsKSL"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="caldif integral.png"></center>
            <h2 class="titulos">Cálculo diferencial e integral de funciones de una variable</h2>
            <center><p class="autor">Autor: Pérez F. J.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://www.ugr.es/~fjperez/textos/calculo_diferencial_integral_func_una_var.pdf&ved=2ahUKEwipwPapq4mGAxW-ke4BHfS2C9kQFnoECAQQAQ&usg=AOvVaw1FHFT9B61M6e6CoGJyf_rh"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="ecuaciones difycalvaracionasl.png"></center>
            <h2 class="titulos">Ecuaciones diferenciales y calculo variacional</h2>
            <center><p class="autor">Autor:  Elsgoltz, L.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://www.academia.edu/37216967/Elsgoltz_Ecuaciones_diferenciales_y_calculo_variacional&ved=2ahUKEwiDx9LvsYmGAxXoHUQIHfufDEIQFnoECBIQAQ&usg=AOvVaw3EB-MDLG3ES9INTVYTTtgQ"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="elementos alg lin.png"></center>
            <h2 class="titulos">Elementos de álgebra lineal y geometría</h2>
            <center><p class="autor">Autor: Fortuny G. y Pérez A. A. J.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://guao.org/sites/default/files/biblioteca/Elementos%2520de%2520%25C3%25A1lgebra%2520lineal%2520y%2520geometr%25C3%25ADa.pdf&ved=2ahUKEwizl8ixsomGAxVXIUQIHcwgBgAQFnoECBUQAQ&usg=AOvVaw2yVclZOhlMV0Nh7mrcDEoH"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="fundamentos algebra.png"></center>
            <h2 class="titulos">Fundamentos de Álgebra</h2>
            <center><p class="autor">Autor:  Zaldivar F.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://luisalexandher.files.wordpress.com/2018/01/fundamentos_de_algebra.pdf&ved=2ahUKEwiZopq108WFAxWh38kDHd2RC98QFnoECAUQAQ&usg=AOvVaw02VkfJetYHjGkYJXd7Dhk7"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="geo ana.png"></center>
            <h2 class="titulos">Geometría Analítica</h2>
            <center><p class="autor">Autor: lehmann autodesk</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://www.cimat.mx/ciencia_para_jovenes/bachillerato/libros/%5BLehmann%5DGeometriaAnalitica.pdf&ved=2ahUKEwjmnsrzsomGAxVQK0QIHRiGDrgQFnoECAUQAQ&usg=AOvVaw2oVB-4YQDydzjroYhgmPUn"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="geo plana y del espacio.png"></center>
            <h2 class="titulos">Geometría plana y del espacio y trigonometría</h2>
            <center><p class="autor">Autor: Baldor A.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://ifdc6m-juj.infd.edu.ar/aula/archivos/repositorio/250/489/Baldor_-_Geometria_Y_Trigonometria.pdf&ved=2ahUKEwj12d3f0MWFAxVq38kDHbBeDDAQFnoECAUQAQ&usg=AOvVaw3jjLwTgxw6dJsFuhfOsmlI"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="geo y trigo.png"></center>
            <h2 class="titulos">Geometría y Aritmética Sen X Cos X</h2>
            <center><p class="autor">Autor: Aguilar A.</p></center>
            <center><a href="https://recuperacionmate2017.wordpress.com/wp-content/uploads/2017/10/geometria-y-trig-conamat.pdf"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="juegos mate.png"></center>
            <h2 class="titulos">Juegos Matemáticos</h2>
            <center><p class="autor">Autor: Almería, Cádiz, Córdoba, Granada, Huelva, Jaén, Málaga y Sevilla.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://www.juntadeandalucia.es/averroes/centros-tic/14002996/helvia/sitio/upload/JUEGOS_MATEMATICOS.pdf&ved=2ahUKEwi0sK7pt4mGAxVhL0QIHZCSA10QFnoECA8QAQ&usg=AOvVaw38nMTBE9_CrpmuX00AFdzr"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="la belleza en las matematicas.png"></center>
            <h2 class="titulos">La belleza en las matemáticas y las matemáticas en la belleza</h2>
            <center><p class="autor">Autor: Licda. Tsijli T.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://cientec.or.cr/archivo/matematica/2012/ponenciasVIII/Teodora-Tsijli.pdf&ved=2ahUKEwj3xLKXwomGAxWcle4BHaORDXkQFnoECC8QAQ&usg=AOvVaw28qFhnpxAchal1tupZ_KP2"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="./img/matematicas 2016.png"></center>
            <h2 class="titulos">Matemáticas cuaderno de actividades de aprendizaje</h2>
            <center><p class="autor">Autor: San L. y San J.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://bcd.cobach.edu.mx/1semestre/CUADERNOS%2520DE%2520ACTIVIDADES/Matematicas_2016.pdf&ved=2ahUKEwiRs9HxromGAxUdLUQIHbNdCR0QFnoECA4QAQ&usg=AOvVaw0c_AzibgUxsLYiaTtyYSxA"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="./img/mate simplificadas.png"></center>
            <h2 class="titulos">Matemáticas Simplificadas</h2>
            <center><p class="autor">Autor: CONAMAT</p></center>
            <center><a href="https://clea.edu.mx/biblioteca/files/original/49e8f315f5a6b3cee6f01470e9093068.pdf"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="img/prob estadistica.png.png"></center>
            <h2 class="titulos">Probabilidad y estadística para ingenieros</h2>
            <center><p class="autor">Autor: Raymond H. Myers</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://vereniciafunez94hotmail.files.wordpress.com/2014/08/8va-probabilidad-y-estadistica-para-ingenier-walpole_8.pdf&ved=2ahUKEwjco4mHxImGAxVCM0QIHZxKD80QFnoECA8QAQ&usg=AOvVaw0YC_ZzFRG2AvVZ-172u_PC"><button>Ver Libro</button></a></center>
        </div>

        <div class="libro">
            <center><img class="contenedor-imagenes-libros" src="algebra de baldor.png"></center>
            <h2 class="titulos">Álgebra de Baldor</h2>
            <center><p class="autor">Autor: Baldor A.</p></center>
            <center><a href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://guao.org/sites/default/files/biblioteca/%25C3%2581lgebra%2520de%2520Baldor.pdf&ved=2ahUKEwjA8rev_sSFAxWXKEQIHbsbCdYQFnoECBwQAQ&usg=AOvVaw1-t86ARykBkubYPEGRYNK6"><button>Ver Libro</button></a></center>
        </div>
        <!--Aqui apareceran los libros agregados-->
    </div>

    <div class="referencias">
        <a href="index.html" class="boton">Inicio</a>
    </div>
    
    <script src="script.js"></script>
    <script>
        const materia = 'matematicas';

        // Función para cargar libros desde el almacenamiento local
function loadBooksFromStorage() {
    const books = JSON.parse(localStorage.getItem(`books_${materia}`)) || [];
    const validBooks = books.filter(book =>
        book.title && book.author && book.image && book.url
    );

    // Ordenar los libros por el título alfabéticamente
    validBooks.sort((a, b) => {
    const titleA = a.title.toLowerCase();
    const titleB = b.title.toLowerCase();
    if (titleA < titleB) return -1;
    if (titleA > titleB) return 1;
    return 0;
});

    // Agregar cada libro ordenado a la página
    validBooks.forEach(book => addBookToPage(book));
}

// Función para agregar un libro y su referencia
function addBookAndReference(newBook) {
    // Verificar si el libro ya está en la lista de libros mostrados
    const books = document.querySelectorAll('.libro');
    for (let i = 0; i < books.length; i++) {
        const book = books[i];
        const titleElement = book.querySelector('.titulos');
        const authorElement = book.querySelector('.autor');

        if (titleElement.innerText.toLowerCase() === newBook.title.toLowerCase() &&
            authorElement.innerText.toLowerCase().includes(newBook.author.toLowerCase())) {
            alert('El libro ya está en la lista.');
            return;
        }
    }

    // Verificar si la referencia ya existe en el almacenamiento local
    const references = JSON.parse(localStorage.getItem('references')) || [];
    for (let i = 0; i < references.length; i++) {
        const reference = references[i];
        if (reference.title.toLowerCase() === newBook.title.toLowerCase() &&
            reference.author.toLowerCase().includes(newBook.author.toLowerCase())) {
            alert('La referencia ya existe.');
            return;
        }
    }

    // Si no existe, agregar el libro y guardar la referencia
    addBookToPage(newBook);
    saveBookAndReference(newBook);
}

// Evento para el formulario de agregar libros
document.addEventListener('DOMContentLoaded', function() {
    loadBooksFromStorage();

    document.getElementById('addBookForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const image = document.getElementById('bookImage').value;
        const author = document.getElementById('bookAuthor').value;
        const title = document.getElementById('bookTitle').value;
        const city = document.getElementById('bookCity').value;
        const editorial = document.getElementById('bookEditorial').value;
        const url = document.getElementById('bookLink').value;
        const newBook = {
            image,
            author,
            title,
            city,
            editorial,
            url,
        };

        addBookAndReference(newBook);

        // Limpiar el formulario y cerrar el modal
        document.getElementById('addBookForm').reset();
        document.getElementById('addBookModal').style.display = 'none';
    });

    // Evento para el campo de búsqueda
    document.getElementById('searchInput').addEventListener('input', searchBooks);

    // Nueva funcionalidad para el modal
    const modal = document.getElementById('addBookModal');
    const btn = document.getElementById('openFormButton');
    const span = document.getElementsByClassName('close')[0];

    // Cuando el usuario hace clic en el botón, abre el modal
    btn.onclick = function() {
        modal.style.display = 'block';
    }

    // Cuando el usuario hace clic en la "x", cierra el modal
    span.onclick = function() {
        modal.style.display ='none';
    }

    // Cuando el usuario hace clic fuera del modal, cierra el modal
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    }
});

// Función para agregar un libro a la página
function addBookToPage(book) {
    const newBookDiv = document.createElement('div');
    newBookDiv.classList.add('libro');
    newBookDiv.innerHTML = `
        <center><img class="contenedor-imagenes-libros" src="${book.image}"></center>
        <h2 class="titulos">${book.title}</h2>
        <center><p class="autor">Autor: ${book.author}</p></center>
        <center><a href="${book.url}"><button>Ver Libro</button></a></center>
    `;
    document.querySelector('#SectionNewBooks').appendChild(newBookDiv);
}

// Función para guardar un libro y su referencia en el almacenamiento local
function saveBookAndReference(book) {
    const books = JSON.parse(localStorage.getItem(`books_${materia}`)) || [];
    books.push(book);
    localStorage.setItem(`books_${materia}`, JSON.stringify(books));

    const reference = createReference(book);
    const references = JSON.parse(localStorage.getItem('references')) || [];
    references.push(reference);
    localStorage.setItem('references', JSON.stringify(references));
}

// Función para crear una referencia APA a partir de un libro
function createReference(book) {
    const year = document.getElementById('year').value || 'S.F.'; // Si no hay año, usar "S.F."
    const reference = {
        title: book.title,
        author: book.author,
        date: `(${year})`,
        city: book.city,
        editorial: book.editorial,
        url: book.url
    };
    return reference;
}
    </script>
</body>
</html>
